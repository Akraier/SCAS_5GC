[INFO] | 2025-06-10 19:44:46 |  Control server listening on port 1337
[INFO] | 2025-06-10 19:44:46 |  AMF_IP 10.100.200.16
[INFO] | 2025-06-10 19:44:46 |  Listening on SCTP port 38412
[INFO] | 2025-06-10 19:44:48 | gNB Connected 10.100.200.13:45073
[INFO] | 2025-06-10 19:44:48 | Connected to AMF 10.100.200.16:38412
[INFO] | 2025-06-10 19:44:48 |  Forwarding gNB -> AMF
[INFO] | 2025-06-10 19:44:48 |  Forwarding AMF -> gNB
[INFO] | 2025-06-10 19:44:49 |  Control connection accepted ('10.100.200.1', 46376)
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 78, in control_server
    logger.info("[CTRL] Received JSON:", msg, flush=True)
  File "/usr/local/lib/python3.11/logging/__init__.py", line 1489, in info
    self._log(INFO, msg, args, **kwargs)
TypeError: Logger._log() got an unexpected keyword argument 'flush'
Exception in thread Thread-1 (control_server):
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor
    self.run()
  File "/usr/local/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/app/sctp_mitm_proxy.py", line 97, in control_server
    conn.send(b"Test KO\n")
OSError: [Errno 9] Bad file descriptor
[INFO] | 2025-06-10 19:44:46 |  Control server listening on port 1337
[INFO] | 2025-06-10 19:44:46 |  AMF_IP 10.100.200.16
[INFO] | 2025-06-10 19:44:46 |  Listening on SCTP port 38412
[INFO] | 2025-06-10 19:44:48 | gNB Connected 10.100.200.13:45073
[INFO] | 2025-06-10 19:44:48 | Connected to AMF 10.100.200.16:38412
[INFO] | 2025-06-10 19:44:48 |  Forwarding gNB -> AMF
[INFO] | 2025-06-10 19:44:48 |  Forwarding AMF -> gNB
[INFO] | 2025-06-10 19:44:49 |  Control connection accepted ('10.100.200.1', 46376)
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 78, in control_server
    logger.info("[CTRL] Received JSON:", msg, flush=True)
  File "/usr/local/lib/python3.11/logging/__init__.py", line 1489, in info
    self._log(INFO, msg, args, **kwargs)
TypeError: Logger._log() got an unexpected keyword argument 'flush'
Exception in thread Thread-1 (control_server):
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor
    self.run()
  File "/usr/local/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/app/sctp_mitm_proxy.py", line 97, in control_server
    conn.send(b"Test KO\n")
OSError: [Errno 9] Bad file descriptor
[INFO] | 2025-06-10 19:44:46 |  Control server listening on port 1337
[INFO] | 2025-06-10 19:44:46 |  AMF_IP 10.100.200.16
[INFO] | 2025-06-10 19:44:46 |  Listening on SCTP port 38412
[INFO] | 2025-06-10 19:44:48 | gNB Connected 10.100.200.13:45073
[INFO] | 2025-06-10 19:44:48 | Connected to AMF 10.100.200.16:38412
[INFO] | 2025-06-10 19:44:48 |  Forwarding gNB -> AMF
[INFO] | 2025-06-10 19:44:48 |  Forwarding AMF -> gNB
[INFO] | 2025-06-10 19:44:49 |  Control connection accepted ('10.100.200.1', 46376)
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 78, in control_server
    logger.info("[CTRL] Received JSON:", msg, flush=True)
  File "/usr/local/lib/python3.11/logging/__init__.py", line 1489, in info
    self._log(INFO, msg, args, **kwargs)
TypeError: Logger._log() got an unexpected keyword argument 'flush'
Exception in thread Thread-1 (control_server):
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor
    self.run()
  File "/usr/local/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/app/sctp_mitm_proxy.py", line 97, in control_server
    conn.send(b"Test KO\n")
OSError: [Errno 9] Bad file descriptor
[INFO] | 2025-06-10 19:44:46 |  Control server listening on port 1337
[INFO] | 2025-06-10 19:44:46 |  AMF_IP 10.100.200.16
[INFO] | 2025-06-10 19:44:46 |  Listening on SCTP port 38412
[INFO] | 2025-06-10 19:44:48 | gNB Connected 10.100.200.13:45073
[INFO] | 2025-06-10 19:44:48 | Connected to AMF 10.100.200.16:38412
[INFO] | 2025-06-10 19:44:48 |  Forwarding gNB -> AMF
[INFO] | 2025-06-10 19:44:48 |  Forwarding AMF -> gNB
[INFO] | 2025-06-10 19:44:49 |  Control connection accepted ('10.100.200.1', 46376)
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 78, in control_server
    logger.info("[CTRL] Received JSON:", msg, flush=True)
  File "/usr/local/lib/python3.11/logging/__init__.py", line 1489, in info
    self._log(INFO, msg, args, **kwargs)
TypeError: Logger._log() got an unexpected keyword argument 'flush'
Exception in thread Thread-1 (control_server):
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
[ERROR] | 2025-06-10 19:44:49 | [!] Error
Traceback (most recent call last):
  File "/app/sctp_mitm_proxy.py", line 76, in control_server
    data = conn.recv(4096).decode('utf-8').strip()
           ^^^^^^^^^^^^^^^
OSError: [Errno 9] Bad file descriptor
    self.run()
  File "/usr/local/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/app/sctp_mitm_proxy.py", line 97, in control_server
    conn.send(b"Test KO\n")
OSError: [Errno 9] Bad file descriptor
[INFO] | 2025-06-10 19:47:21 |  Control server listening on port 1337
[INFO] | 2025-06-10 19:47:21 |  AMF_IP 10.100.200.16
[INFO] | 2025-06-10 19:47:21 |  Listening on SCTP port 38412
[INFO] | 2025-06-10 19:47:22 | gNB Connected 10.100.200.13:45706
[INFO] | 2025-06-10 19:47:22 | Connected to AMF 10.100.200.16:38412
[INFO] | 2025-06-10 19:47:22 |  Forwarding gNB -> AMF
[INFO] | 2025-06-10 19:47:22 |  Forwarding AMF -> gNB
[INFO] | 2025-06-10 19:47:23 |  Control connection accepted ('10.100.200.1', 60746)
[INFO] | 2025-06-10 19:47:23 | [CTRL] Received JSON:
[INFO] | 2025-06-10 19:47:23 |  Test case: tc_amf_nas_integrity_failure STARTED
[INFO] | 2025-06-10 19:47:23 |  Trying to inject b'\x00.@C\x00\x00\x04\x00\n\x00\x02\x00\x01\x00U\x00\x02\x00\x01\x00&\x00\x19\x18~\x02\xff\xff\xff\xff\x04~\x00E\x01\x00\x0b\xf2\x02\xf89\xca\xfe\x00\x00\x00\x00\x01\x00y@\x13P\x02\xf89\x00\x00\x00\x01\x00\x02\xf89\x00\x00\x01\xeb\x85d\x06'
[INFO] | 2025-06-10 19:47:23 |  tc_amf_nas_integrity_failure injected
[INFO] | 2025-06-10 19:47:23 |  Test case: tc_amf_nas_integrity_failure FINISHED
[INFO] | 2025-06-10 19:47:26 | [CTRL] Received JSON:
[INFO] | 2025-06-10 19:47:26 |  Test case: tc_nas_replay_amf STARTED
[INFO] | 2025-06-10 19:47:26 |  Trying to inject b'\x00.@o\x00\x00\x04\x00\n\x00\x02\x00\x01\x00U\x00\x02\x00\x01\x00&\x00ED~\x04\xd9\x80)\xbf\x00~\x00^w\x00\tEs\x80a!\x85aQ\xf1q\x00+~\x00Ay\x00\r\x01\x02\xf89\x00\x00\x00\x00\x00\x00\x00\x00\x10\x10\x01\x00.\x04\xf0\xf0\xf0\xf0/\n\x04\x01\x01\x02\x03\x04\x01\x11"3S\x01\x00\x00y@\x13P\x02\xf89\x00\x00\x00\x01\x00\x02\xf89\x00\x00\x01\xeb\xf3\nK'
[INFO] | 2025-06-10 19:47:26 |  tc_nas_replay_amf injected
[INFO] | 2025-06-10 19:47:26 |  Test case: tc_nas_replay_amf FINISHED
[INFO] | 2025-06-10 19:47:29 | [CTRL] Received JSON:
[INFO] | 2025-06-10 19:47:29 |  Test case: tc_ue_sec_cap_handling_amf STARTED
[INFO] | 2025-06-10 19:47:29 |  Trying to inject b'\x00\x0f@H\x00\x00\x05\x00U\x00\x02\x00\x01\x00&\x00\x1a\x19~\x00Ay\x00\r\x01\x02\xf89\x00\x00\x00\x00\x00\x00\x00\x00\x10.\x04\x00\x00\x00\x00\x00y\x00\x13P\x02\xf89\x00\x00\x00\x01\x00\x02\xf89\x00\x00\x01\xeb\xf3\nK\x00Z@\x01\x18\x00p@\x01\x00'
[INFO] | 2025-06-10 19:47:29 |  tc_ue_sec_cap_handling_amf injected
[INFO] | 2025-06-10 19:47:29 |  Test case: tc_ue_sec_cap_handling_amf FINISHED
